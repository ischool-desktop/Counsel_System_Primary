<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type="text/xsl" href="format.xsl" ?>
<ValidateRule Name="晤談紀錄">
  <DuplicateDetection>
    <Detector Name="PrimaryKey1">
      <Field Name="學號" />
	    <Field Name="狀態" />
      <Field Name="日期" />      
      <Field Name="晤談事由" />
    </Detector>
  </DuplicateDetection>
  <FieldList>

    <Field Required="True" Name="學號">
      <Validate AutoCorrect="False" Description="「學號」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>

    <Field Required="True" Name="狀態">
      <Validate AutoCorrect="False" Description="「狀態」請填入「一般、延修、休學、輟學、畢業或離校」。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>

    <Field Required="False" Name="姓名">
    </Field>

    <Field Required="False" Name="晤談編號">      
    </Field>

    <Field Required="True" Name="晤談老師">
      <Validate AutoCorrect="False" Description="「晤談老師」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>

    <Field Required="True" Name="晤談方式">
      <Validate AutoCorrect="False" Description="「晤談方式」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>

    <Field Required="True" Name="晤談對象">
      <Validate AutoCorrect="False" Description="「晤談對象」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>
    
	<Field Required="True" Name="日期">
      <Validate AutoCorrect="False" Description="「日期」不允許空白。" ErrorType="Error" Validator="合法日期" When="" />
    </Field>

    <Field Required="False" Name="時間">      
    </Field>

    <Field Required="False" Name="地點">    
    </Field>

	<Field Required="True" Name="晤談事由">
      <Validate AutoCorrect="False" Description="「晤談事由」不允許空白。" ErrorType="Error" Validator="不可空白" When="" />
    </Field>

    <Field Required="False" Name="參與人員:學生" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:學生」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:家長" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:家長」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:專家" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:專家」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:醫師" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:醫師」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:社工人員" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:社工人員」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:導師" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:導師」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:教官" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:教官」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:輔導老師" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:輔導老師」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:任課老師" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:任課老師」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:其它" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「參與人員:其它」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="參與人員:其它備註" >
      
    </Field>
    <Field Required="False" Name="輔導方式:暫時結案" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:暫時結案」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:專案輔導" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:專案輔導」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:導師輔導" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:導師輔導」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:轉介" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:轉介」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:轉介備註" >
     
    </Field>
    <Field Required="False" Name="輔導方式:就醫" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:就醫」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:就醫備註">
      
    </Field>
    <Field Required="False" Name="輔導方式:其它" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導方式:其它」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導方式:其它備註">
      
    </Field>
    <Field Required="False" Name="輔導歸類:違規" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:違規」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:遲曠" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:遲曠」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:學習" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:學習」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:生涯" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:生涯」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:人" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:人」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:休退轉" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:休退轉」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:家庭" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:家庭」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:師生" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:師生」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:情感" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:情感」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:精神" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:精神」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:家暴" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:家暴」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:霸凌" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:霸凌」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:中輟" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:中輟」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:性議題" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:性議題」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:戒毒" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:戒毒」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:網路成癮" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:網路成癮」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:情緒障礙" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:情緒障礙」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:其它" EmptyAlsoValidate="False">
      <Validate AutoCorrect="False" Description="「輔導歸類:其它」請填1或空白。" ErrorType="Error" Validator="勾選列舉" When="" />
    </Field>
    <Field Required="False" Name="輔導歸類:其它備註" >      
    </Field>
    <Field Required="False" Name="內容要點">      
    </Field>
    <Field Required="False" Name="記錄者">
    </Field>
    <Field Required="False" Name="記錄者姓名">
    </Field>
  </FieldList>
  <ValidatorList>
    <FieldValidator Name="不可空白" Type="STRINGLENGTH">
      <MinLength>1</MinLength>
    </FieldValidator>
    <FieldValidator Name="勾選列舉" Type="Enumeration">
      <Item Value="1"/>
      <Item Value=""/>
    </FieldValidator>
    <RowValidator Name="老師是否存在" Type="CHECKTEACHERNAMERVAL"/>
    <RowValidator Name="學號是否存在" Type="COUNSELSTUDCHECKSTUDENTNUMBERSTATUSVAL"/>
    <FieldValidator Name="合法日期" Type="MixDate">
      <!-- Gregorian | Taiwan-->
      <!-- Pattern 中需要 Year,Month,Day 三個 Group。-->
      <!-- 2007/8/8 (年/月/日) -->
      <ValidPattern DateType="Gregorian">
        <![CDATA[^(?<Year>[0-9]{4})/(?<Month>[0-9]{1,2})/(?<Day>[0-9]{1,2})$]]>
      </ValidPattern>
      <Matchs CorrectTo="yyyy/MM/dd">
        <!-- 96/8/8 (年/月/日)-->
        <Match DateType="Taiwan"><![CDATA[^(?<Year>1?[0-9]{3})/(?<Month>[0-9]{1,2})/(?<Day>[0-9]{1,2})$]]></Match>
        <!-- 96-8-8 (年-月-日)-->
        <Match DateType="Taiwan"><![CDATA[^(?<Year>1?[0-9]{3})-(?<Month>[0-9]{1,2})-(?<Day>[0-9]{1,2})$]]></Match>
        <!-- 960808 (年月日)-->
        <Match DateType="Taiwan"><![CDATA[^(?<Year>1?[0-9]{3})(?<Month>[0-9]{2})(?<Day>[0-9]{2})$]]></Match>
        <!-- 2007-8-8 (年/月/日)-->
        <Match DateType="Gregorian"><![CDATA[^(?<Year>[0-9]{4})-(?<Month>[0-9]{1,2})-(?<Day>[0-9]{1,2})$]]></Match>
        <!-- 8-8-2007 (月/日/年)-->
        <Match DateType="Gregorian"><![CDATA[^(?<Month>[0-9]{1,2})-(?<Day>[0-9]{1,2})-(?<Year>[0-9]{4})$]]></Match>
        <!-- 20070812 (年月日)-->
        <Match DateType="Gregorian"><![CDATA[^(?<Year>[0-9]{4})(?<Month>[0-9]{2})(?<Day>[0-9]{2})$]]></Match>
      </Matchs>
    </FieldValidator>
  </ValidatorList>

  <RowValidate>
    <Validate AutoCorrect="False" Description="「學號+狀態」不存在系統內。" ErrorType="Error" Validator="學號是否存在" When=""/>
    <Validate AutoCorrect="False" Description="「老師」不存在系統內。" ErrorType="Error" Validator="老師是否存在" When=""/>
  </RowValidate>
  
  <ConditionList/>
</ValidateRule>